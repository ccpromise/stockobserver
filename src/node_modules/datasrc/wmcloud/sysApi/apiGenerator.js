
const utility = require('utility');
const access_token = require('config').access_token;

httpOpt = {
    host: 'api.wmcloud.com',
    headers: {
        'Authorization': 'Bearer ' + access_token,
    },
    useHttps: true
}

module.exports = function (path, queryFields) {
    return function (usrQuery) {
        return Promise.resolve().then(() => {
            var opt = utility.object.clone(httpOpt);
            opt.path = path;
            opt.query = queryFields.map((field) => field + '=' + (usrQuery[field] || '')).join('&');
            return utility.request(opt).then((r) => {
                return JSON.parse(r.toString());
            });
        })
    }
}
