
const StockDataPvd = require('./StockDataPvd');
const propDataPvd = require('../basicDataPvd').PropDataPvd;
const loadStockData = require('stockData').loadStockData;
const utility = require('utility');
const validate = utility.validate;

function checkParams (secID) {
    return validate.isStr(secID);
}

function pvdID (secID, propName) {
    return propName + '_' + secID;
}

function makePvd (secID, propName, id) {
    return loadStockData(secID).then((r) => {
        var stockPvd = new StockDataPvd(r, secID);
        return propDataPvd.makePvd({ pvd: stockPvd, propName: propName }, id);
    })
}

module.exports = function (propName) {
    return {
        checkParams: checkParams,
        pvdID: (secID) => pvdID(secID, propName),
        makePvd: (secID, id) => makePvd(secID, propName, id)
    }
}
