
const StockDataPvd = require('./StockDataPvd');
const loadStockData = require('stockData').loadStockData;
const utility = require('utility');
const validate = utility.validate;
const object = utility.object;
const time = utility.time;

/**
 * provide end data of stock
 */
function EndDataPvd(stock, id) {
    StockDataPvd.call(this, stock, id);
}

EndDataPvd.prototype = Object.create(StockDataPvd.prototype);

EndDataPvd.prototype.get = function(ts) {
    if(!this.hasDef(ts)) throw new Error('invalid ts: ', ts);
    return this.stock[ts]['e'];
}

function checkParams(secID) {
    return validate.isStr(secID);
}

function pvdID(secID) {
    return 'end' + '_' + secID;
}

function makePvd(secID, id) {
    return loadStockData(secID).then((stock) => {
        return new EndDataPvd(stock, id);
    });
}

module.exports = {
    'checkParams': checkParams,
    'pvdID': pvdID,
    'makePvd': makePvd
}
